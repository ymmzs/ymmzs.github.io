<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <title>å‘˜å·¥æ‰“å¡å¯è§†åŒ–</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    html, body, #map {
      height: 100%;
      margin: 0;
      padding: 0;
    }
  </style>
  <script src="https://webapi.amap.com/maps?v=2.0&key=b479b036079bc0579bc23d62cdfdfb6b&plugin=AMap.MarkerCluster,AMap.ToolBar,AMap.Scale"></script>
</head>
<body>
  <div id="map"></div>
  <script>
    var map = new AMap.Map('map', {
      zoom: 5,
      center: [113.462747, 24.667952],
      viewMode: '2D'
    });

    var points = [{"name": "é¾šæ¥", "address": "å¹¿ä¸œçœç æµ·å¸‚é‡‘æ¹¾åŒºåˆ›ä¸šä¸­è·¯2å·", "province": "å¹¿ä¸œçœ", "position": [113.281266, 22.08831], "content": "<b>ğŸ‘¤ å§“åï¼š</b>é¾šæ¥<br/><b>ğŸ“ åœ°å€ï¼š</b>å¹¿ä¸œçœ å¹¿ä¸œçœç æµ·å¸‚é‡‘æ¹¾åŒºåˆ›ä¸šä¸­è·¯2å·"}, {"name": "é¾™è¿œå¿—", "address": "çœ‰å±±å¸‚ä¸œå¡åŒºä¸œå¡åŒºé˜³å…‰æœªæ¥åŸ(èœ€å±±è·¯å—)", "province": "å››å·çœ", "position": [103.833874, 30.068128], "content": "<b>ğŸ‘¤ å§“åï¼š</b>é¾™è¿œå¿—<br/><b>ğŸ“ åœ°å€ï¼š</b>å››å·çœ çœ‰å±±å¸‚ä¸œå¡åŒºä¸œå¡åŒºé˜³å…‰æœªæ¥åŸ(èœ€å±±è·¯å—)"}, {"name": "é¾™å¼€å‰ï¼Œé½å®—ï¼Œé»„é›„å®‰ï¼Œé»„è¹ï¼Œé»„ç«‹å‹‡ï¼Œé»„æ¶¦é¾™ï¼Œé»„æ¡‚è´µï¼Œé»„æ™¨æ›¦ï¼Œé»„æ™“çœŸï¼Œé»„å°§ï¼Œé»„å®¶ç…§ï¼Œé»„å¦™åï¼Œé»„ä¿Šï¼Œé«˜é¹é£ï¼Œé«˜å°äº‘ï¼Œé©¬ç£Šï¼Œé©¬æ°æ—", "address": "å¹¿ä¸œçœä¸œèå¸‚è¶…ä¸œè·¯82å·", "province": "å¹¿ä¸œçœ", "position": [113.914478, 23.040178], "content": "<b>ğŸ‘¤ å§“åï¼š</b>é¾™å¼€å‰ï¼Œé½å®—ï¼Œé»„é›„å®‰ï¼Œé»„è¹ï¼Œé»„ç«‹å‹‡ï¼Œé»„æ¶¦é¾™ï¼Œé»„æ¡‚è´µï¼Œé»„æ™¨æ›¦ï¼Œé»„æ™“çœŸï¼Œé»„å°§ï¼Œé»„å®¶ç…§ï¼Œé»„å¦™åï¼Œé»„ä¿Šï¼Œé«˜é¹é£ï¼Œé«˜å°äº‘ï¼Œé©¬ç£Šï¼Œé©¬æ°æ—<br/><b>ğŸ“ åœ°å€ï¼š</b>å¹¿ä¸œçœ å¹¿ä¸œçœä¸œèå¸‚è¶…ä¸œè·¯82å·"}, {"name": "é»å‹‡", "address": "å¹¿ä¸œçœæ·±åœ³å¸‚é¾™å²—åŒºå®é¾™ä¸€è·¯å®é¾™ä¸€è·¯27-5å·", "province": "å¹¿ä¸œçœ", "position": [114.286956, 22.687053], "content": "<b>ğŸ‘¤ å§“åï¼š</b>é»å‹‡<br/><b>ğŸ“ åœ°å€ï¼š</b>å¹¿ä¸œçœ å¹¿ä¸œçœæ·±åœ³å¸‚é¾™å²—åŒºå®é¾™ä¸€è·¯å®é¾™ä¸€è·¯27-5å·"}, {"name": "é»„é’°æ¾", "address": "å››å·çœçœ‰å±±å¸‚ä¸œå¡åŒºé«˜æ–°æŠ€æœ¯äº§ä¸šå›­åŒºä¸‡åå¤§é“1å·", "province": "å››å·çœ", "position": [103.764853, 30.036396], "content": "<b>ğŸ‘¤ å§“åï¼š</b>é»„é’°æ¾<br/><b>ğŸ“ åœ°å€ï¼š</b>å››å·çœ å››å·çœçœ‰å±±å¸‚ä¸œå¡åŒºé«˜æ–°æŠ€æœ¯äº§ä¸šå›­åŒºä¸‡åå¤§é“1å·"}, {"name": "é»„æ˜çœŸ", "address": "å®‰å¾½çœæ·®åŒ—å¸‚ç›¸å±±åŒºé—¸æ²³è·¯", "province": "å®‰å¾½çœ", "position": [116.802292, 33.969743], "content": "<b>ğŸ‘¤ å§“åï¼š</b>é»„æ˜çœŸ<br/><b>ğŸ“ åœ°å€ï¼š</b>å®‰å¾½çœ å®‰å¾½çœæ·®åŒ—å¸‚ç›¸å±±åŒºé—¸æ²³è·¯"}, {"name": "é»„æ–¹çƒ¨", "address": "å¸¸å·å¸‚æº§é˜³å¸‚æº§é˜³å¸‚è’‹åº—æ–°åŸ", "province": "æ±Ÿè‹çœ", "position": [119.415721, 31.442724], "content": "<b>ğŸ‘¤ å§“åï¼š</b>é»„æ–¹çƒ¨<br/><b>ğŸ“ åœ°å€ï¼š</b>æ±Ÿè‹çœ å¸¸å·å¸‚æº§é˜³å¸‚æº§é˜³å¸‚è’‹åº—æ–°åŸ"}, {"name": "é»„å¿—å›½", "address": "æ¹–åŒ—çœå®œæ˜Œå¸‚å…´å±±å¿æ€ä¹¡è·¯", "province": "æ¹–åŒ—çœ", "position": [110.759097, 31.228418], "content": "<b>ğŸ‘¤ å§“åï¼š</b>é»„å¿—å›½<br/><b>ğŸ“ åœ°å€ï¼š</b>æ¹–åŒ—çœ æ¹–åŒ—çœå®œæ˜Œå¸‚å…´å±±å¿æ€ä¹¡è·¯"}, {"name": "é»„å®å…‰", "address": "ç¦å»ºçœå®å¾·å¸‚è•‰åŸåŒºæŒ¯å…´è·¯", "province": "ç¦å»ºçœ", "position": [119.55388, 26.718301], "content": "<b>ğŸ‘¤ å§“åï¼š</b>é»„å®å…‰<br/><b>ğŸ“ åœ°å€ï¼š</b>ç¦å»ºçœ ç¦å»ºçœå®å¾·å¸‚è•‰åŸåŒºæŒ¯å…´è·¯"}, {"name": "é«˜èŒ‚è™", "address": "å¹¿ä¸œçœè‚‡åº†å¸‚é«˜è¦åŒºåˆ›ä¸šå››è·¯", "province": "å¹¿ä¸œçœ", "position": [112.792046, 23.087862], "content": "<b>ğŸ‘¤ å§“åï¼š</b>é«˜èŒ‚è™<br/><b>ğŸ“ åœ°å€ï¼š</b>å¹¿ä¸œçœ å¹¿ä¸œçœè‚‡åº†å¸‚é«˜è¦åŒºåˆ›ä¸šå››è·¯"}, {"name": "éª†ç¤¼å†›", "address": "å¹¿ä¸œçœè‚‡åº†å¸‚é«˜è¦åŒºY184ä¸Y235äº¤å‰å£ä¸œåŒ—æ–¹å‘1430ç±³å·¦å³", "province": "å¹¿ä¸œçœ", "position": [112.458055, 23.02474], "content": "<b>ğŸ‘¤ å§“åï¼š</b>éª†ç¤¼å†›<br/><b>ğŸ“ åœ°å€ï¼š</b>å¹¿ä¸œçœ å¹¿ä¸œçœè‚‡åº†å¸‚é«˜è¦åŒºY184ä¸Y235äº¤å‰å£ä¸œåŒ—æ–¹å‘1430ç±³å·¦å³"}];
    var provinceCounts = {"å¹¿ä¸œçœ": 21, "å››å·çœ": 2, "å®‰å¾½çœ": 1, "æ±Ÿè‹çœ": 1, "æ¹–åŒ—çœ": 1, "ç¦å»ºçœ": 1};
    var infoWin = new AMap.InfoWindow({ offset: new AMap.Pixel(0, -30) });

    // åˆ›å»º markerï¼ˆçº¢è‰²å›¾æ ‡ï¼‰
    var markers = points.map(function(p) {
      var marker = new AMap.Marker({
        position: p.position,
        title: p.name,
        icon: new AMap.Icon({
          size: new AMap.Size(25, 34),
          image: 'https://webapi.amap.com/theme/v1.3/markers/n/mark_r.png',
          imageSize: new AMap.Size(25, 34)
        })
      });
      marker.on('click', function() {
        infoWin.setContent('<div style="font-size:14px;">' + p.content + '</div>');
        infoWin.open(map, p.position);
      });
      return marker;
    });
    map.add(markers);
    map.setFitView(markers, true, [50,50,50,50]);

    // åŠ è½½çœä»½ GeoJSON å¹¶é«˜äº®
    fetch('https://geo.datav.aliyun.com/areas_v3/bound/100000_full.json')
      .then(res => res.json())
      .then(geojson => {
        geojson.features.forEach(f => {
          var provName = f.properties.name;
          var count = provinceCounts[provName] || provinceCounts[provName + "çœ"] || 0;
          if (count > 0) {
            var coords = [];
            if (f.geometry.type === "Polygon") {
              coords = f.geometry.coordinates.map(ring =>
                ring.map(coord => [coord[0], coord[1]])
              );
            } else if (f.geometry.type === "MultiPolygon") {
              coords = f.geometry.coordinates.flat().map(ring =>
                ring.map(coord => [coord[0], coord[1]])
              );
            }
            var polygon = new AMap.Polygon({
              path: coords,
              strokeColor: '#ff6666',
              strokeWeight: 1,
              fillColor: '#ff9999',
              fillOpacity: 0.08
            });
            polygon.on('mouseover', function() {
              polygon.setOptions({ fillOpacity: 0.25, strokeWeight: 2 });
            });
            polygon.on('mouseout', function() {
              polygon.setOptions({ fillOpacity: 0.08, strokeWeight: 1 });
            });
            map.add(polygon);

            var bounds = polygon.getBounds();
            var center = bounds.getCenter();
            var text = new AMap.Text({
              position: center,
              text: provName + 'ï¼šæ€»è®¡ ' + count + ' äºº',
              style: {
                'background': 'rgba(255,255,255,0.95)',
                'padding': '4px 8px',
                'border': '1px solid #ff6666',
                'border-radius': '4px',
                'font-weight': 'bold'
              },
              zIndex: 200
            });
            text.setMap(map);
          }
        });
      });

    new AMap.MarkerCluster(map, markers, { gridSize: 80 });
    map.addControl(new AMap.ToolBar());
    map.addControl(new AMap.Scale());
  </script>
</body>
</html>